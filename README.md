# 计算机视觉与深度学习实验项目

这是一个基于Python的综合计算机视觉与深度学习实验项目，包含图像处理、神经网络训练、迁移学习和网络协议分析等多个实验模块，提供交互式的学习体验。

**作者**: dobqop999@gmail.com
**GitHub**: [https://github.com/quitedob/visionhomework](https://github.com/quitedob/visionhomework)

## 项目结构

```
visionhomework/
├── .gitignore                 # Git忽略文件配置（包含缓存和临时文件规则）
├── .venv/                     # 虚拟环境目录
├── Test1.py                   # OpenCV图像处理实验主程序（缓存优化+多线程）
├── test2.py                   # PyTorch MNIST手写数字识别实验（高级GUI版本）
├── Test3.py                   # PyTorch ResNet50迁移学习猫狗分类实验（增强版）
├── IE_class.py               # IEEE 802.3以太网帧封装工具（教材变体CRC-32）
├── IE.py                      # IEEE 802.3以太网帧封装工具（兼容版本）
├── requirements.txt           # 项目依赖列表
├── resnet50_config.json       # ResNet50模型配置文件
├── temp_canvas.ps             # 临时画布文件（PostScript格式）
├── transferResNet50/         # ResNet50模型保存目录
├── data/                      # 数据集目录
│   └── MNIST/                 # MNIST数据集
└── README.md                  # 项目说明文档
```

## 实验模块

### 1. OpenCV图像处理实验 (Test1.py)
**交互式图像处理学习平台（缓存优化+多线程版本）**

- **核心功能**：
  - 交互式图像处理实验演示（8个实验步骤）
  - 智能缓存机制（LRU缓存+弱引用缓存）
  - 多线程后台处理（避免GUI阻塞）
  - 自适应图像显示（动态缩放避免黑边）
  - 实时参数调节（动态JPEG/PNG对比）
  - 支持中英文界面切换
  - 现代化标签页UI设计

- **技术亮点**：
  - **智能缓存系统**：LRU缓存图像处理结果，显著提升重复操作性能
  - **多线程架构**：后台线程处理复杂图像操作，主线程保持UI响应
  - **自适应显示**：根据画布大小动态调整图像显示比例
  - **动态参数调节**：实时滑动条控制JPEG质量和PNG压缩参数
  - **内存优化**：弱引用缓存和定期清理机制

- **实验步骤**：
  1. **图像选择和加载** - 智能缓存避免重复加载
  2. **图像读取和属性显示** - 完整的图像元数据显示
  3. **JPEG质量对比** - 实时参数调节（0-100质量范围）
  4. **PNG压缩对比** - 动态压缩级别调节（0-9级别）
  5. **灰度图像分离** - 颜色通道分离演示
  6. **图像创建和复制** - 自适应通道分离显示
  7. **RGB通道分离** - 多线程处理大图像
  8. **BGR与RGB色彩空间对比** - 缓存优化色彩空间转换

### 2. PyTorch MNIST手写数字识别 (test2.py)
**深度学习入门实验 - 高级GUI版本（缓存优化+实时监控）**

- **核心功能**：
  - 基于卷积神经网络的MNIST手写数字识别
  - 现代化标签页GUI界面（5个功能标签页）
  - 实时训练进度监控和可视化（Matplotlib集成）
  - 步骤化交互式实验引导（6个实验步骤）
  - 手写数字画板识别功能
  - 模型保存/加载和批量测试
  - 智能数据集缓存（避免重复下载）

- **技术特点**：
  - **智能缓存系统**：LRU缓存+弱引用缓存，显著提升性能
  - **实时训练监控**：损失曲线、准确率曲线、学习率变化
  - **多线程架构**：后台训练线程+消息队列通信
  - **现代化CNN架构**：Conv2D+BatchNorm+Dropout+Adam优化器
  - **学习率调度器**：StepLR自动调整学习率
  - **批量测试分析**：详细的类别准确率分析
  - **Matplotlib集成**：高质量的训练可视化图表

- **实验步骤**：
  1. **数据加载** - 智能缓存检查，避免重复下载
  2. **数据预览** - 样本可视化和统计分析
  3. **模型搭建** - CNN架构展示和参数配置
  4. **模型训练** - 实时进度监控和曲线绘制
  5. **模型测试** - 批量测试和混淆矩阵分析
  6. **手写识别** - 交互式数字绘制和识别

### 3. ResNet50迁移学习猫狗分类 (Test3.py)
**高级深度学习实验 - 增强版迁移学习（性能监控+智能缓存）**

- **核心功能**：
  - 使用预训练ResNet50进行迁移学习
  - 猫狗二分类任务（可配置样本数量）
  - 智能数据集缓存系统（避免重复处理）
  - 系统资源实时监控（CPU/内存使用率）
  - 现代化GUI界面（5个功能标签页）
  - 单张/批量图像预测功能
  - 模型保存/加载和配置管理

- **技术特点**：
  - **智能缓存系统**：检查缓存有效性，避免重复数据处理
  - **性能监控面板**：实时CPU/内存监控和优化建议
  - **迁移学习策略**：微调vs特征提取，可配置学习率
  - **ReduceLROnPlateau调度器**：基于验证准确率的智能学习率调整
  - **增强数据增强**：随机旋转、裁剪、颜色抖动等
  - **多线程架构**：后台处理避免GUI阻塞
  - **配置持久化**：JSON配置管理和实验日志记录

- **实验步骤**：
  1. **数据集设置** - 智能缓存检查和数据加载
  2. **模型配置** - 迁移学习策略和参数设置
  3. **训练监控** - 实时进度和性能曲线可视化
  4. **模型测试** - 单张图片和批量测试分析
  5. **性能监控** - 系统资源监控和优化建议

### 4. IEEE 802.3以太网帧封装工具 (IE_class.py)
**网络协议分析实验（教材变体CRC-32实现）**

- **核心功能**：
  - IEEE 802.3标准以太网帧封装（教材变体）
  - 专用CRC-32校验和计算（非标准以太网版本）
  - 完整帧结构可视化（前导码+SFD+MAC头+数据+FCS）
  - 交互式参数调整和实时验证
  - 多标签页结果展示（详细/十六进制/帧结构）

- **技术特点**：
  - **教材变体CRC-32**：poly=0x04C11DB7, refin=False, refout=False
  - **精确校验和计算**：确保"hello world"输出A4484EFF
  - **完整帧封装流程**：从MAC地址到FCS的完整实现
  - **数据填充处理**：自动填充到最小46字节
  - **多格式输出**：十六进制、分组显示、结构化分析
  - **错误处理和验证**：实时输入验证和错误提示

- **关键差异（相对标准以太网）**：
  - CRC采用"变体"CRC-32：非反射 refin=False/refout=False
  - 初始化值init=0x00000000，XOR输出值xorout=0x00000000
  - CRC输入不含前导码和SFD，只包含Dest+Src+Length+Data

## 环境配置

### 依赖库安装

项目需要以下主要依赖库：

- **OpenCV (opencv-python)** - 计算机视觉库
- **NumPy** - 数值计算库
- **Pillow (PIL)** - 图像处理库
- **PyTorch (torch)** - 深度学习框架
- **TorchVision (torchvision)** - PyTorch计算机视觉库
- **Matplotlib** - 数据可视化库
- **tkinter** - GUI界面库（Python内置）
- **tqdm** - 进度条库
- **psutil** - 系统资源监控（Test3.py）
- **seaborn** - 增强可视化库
- **GPUtil** - GPU监控（可选，Test3.py）

### PyTorch安装

在运行PyTorch相关实验前，请确保正确安装PyTorch。您可以访问 [PyTorch官网](https://pytorch.org/get-started/locally/) 根据您的系统配置选择合适的安装方式。

### 使用虚拟环境

项目已配置虚拟环境，包含所有必要的依赖库。

### 激活虚拟环境

#### Windows:
```bash
# 激活虚拟环境
.venv\Scripts\activate

# 退出虚拟环境
deactivate
```

#### Linux/Mac:
```bash
# 激活虚拟环境
source .venv/bin/activate

# 退出虚拟环境
deactivate
```

## 运行程序

激活虚拟环境后，可以运行以下程序：

### OpenCV图像处理实验
```bash
python Test1.py
```
*启动交互式图像处理学习平台，支持8个实验步骤和参数调节*

### PyTorch MNIST手写数字识别实验
```bash
python test2.py
```
*启动现代化的图形界面，支持标签页操作、实时训练监控和手写识别*

### PyTorch ResNet50迁移学习猫狗分类实验
```bash
python Test3.py
```
*启动增强版迁移学习实验，包含系统监控、性能分析和高级训练功能*

### IEEE 802.3以太网帧封装工具
```bash
python IE.py
```
*启动网络协议分析工具，支持以太网帧封装和CRC校验计算*

## 技术亮点

### 🎯 现代化GUI设计
- **多标签页界面**：清晰的功能分区和导航（3-5个标签页设计）
- **响应式布局**：支持窗口缩放和自适应显示
- **现代化主题**：统一的颜色方案和视觉风格
- **中英文双语**：国际化界面支持和实时切换

### ⚡ 智能性能优化
- **LRU缓存系统**：functools.lru_cache装饰器优化
- **弱引用缓存**：weakref.WeakValueDictionary防止内存泄漏
- **多线程架构**：threading.Thread+queue.Queue消息通信
- **智能数据集缓存**：JSON元数据管理，避免重复处理
- **后台任务队列**：异步处理复杂计算任务
- **自适应显示**：根据画布大小动态调整图像比例

### 📊 实时监控与分析
- **训练进度监控**：实时显示损失、准确率曲线
- **系统资源监控**：CPU、内存、GPU使用率追踪
- **性能优化建议**：智能分析系统状态并提供优化建议
- **详细日志记录**：完整的实验过程记录

### 🔬 完整的实验流程
- **步骤化引导**：从数据加载到模型部署的完整流程
- **智能缓存系统**：避免重复计算，提升实验效率
- **实时监控可视化**：训练进度、系统资源、性能指标
- **交互式参数调节**：实时调整参数并观察效果
- **多线程后台处理**：复杂的计算任务不阻塞用户界面

## 学习路径

### 📚 初学者路径
1. **OpenCV图像处理实验 (Test1.py)** - 理解图像处理基础
2. **MNIST手写数字识别 (test2.py)** - 深度学习入门
3. **以太网帧封装工具 (IE.py)** - 网络协议基础
4. **ResNet50迁移学习 (Test3.py)** - 高级深度学习应用

### 🎯 专项学习路径

#### 计算机视觉方向
- OpenCV基础 → 深度学习入门 → 迁移学习应用

#### 网络协议方向
- 以太网帧结构 → CRC校验算法 → 网络编程基础

#### 深度学习方向
- CNN原理 → 迁移学习 → 系统优化与监控

## 数据集准备

### MNIST数据集
实验2和实验3中的MNIST数据集会在首次运行时自动下载，无需手动准备。

### 猫狗分类数据集（实验3可选）
如需运行完整的猫狗分类实验，请按以下结构组织数据：

```
data/DogsVSCats/
├── train/
│   ├── cat/     # 猫的训练图片 (jpg/png格式)
│   └── dog/     # 狗的训练图片 (jpg/png格式)
└── valid/
    ├── cat/     # 猫的验证图片 (jpg/png格式)
    └── dog/     # 狗的验证图片 (jpg/png格式)
```

您可以从https://www.microsoft.com/en-us/download/details.aspx?id=54765&utm_source=chatgpt.com

## 依赖库说明

### 核心依赖库
- `opencv-python==4.12.0.88` - OpenCV计算机视觉库（图像处理）
- `numpy==2.2.6` - 数值计算库（矩阵运算）
- `torch==2.8.0` - PyTorch深度学习框架
- `torchvision==0.23.0` - PyTorch计算机视觉库（预训练模型、数据集）
- `matplotlib==3.10.7` - 数据可视化库（图表绘制）
- `Pillow==11.3.0` - Python图像处理库（GUI图像显示）
- `tkinter` - GUI界面库（Python内置）

### 高级功能依赖库
- `tqdm==4.67.1` - 进度条库（训练进度显示）
- `psutil==7.1.1` - 系统资源监控（CPU、内存使用率）
- `seaborn==0.13.2` - 增强可视化库（统计图表）
- `pandas==2.3.3` - 数据分析库
- `requests==2.32.5` - HTTP网络库

### Python内置库（无需安装）
- `weakref` - 弱引用缓存
- `functools` - 高阶函数（LRU缓存）
- `threading` - 多线程支持
- `queue` - 线程安全队列
- `json` - JSON配置处理
- `datetime` - 时间戳记录

### 版本说明
- requirements.txt已更新为当前环境的确切版本号
- 所有包版本经过测试，确保兼容性
- 建议使用`pip install -r requirements.txt`安装依赖

## 故障排除

### 常见问题

**1. GUI界面无法启动**
- 确保已安装tkinter：`python -m tkinter`
- 检查虚拟环境是否正确激活
- 确认matplotlib后端设置为TkAgg

**2. PyTorch相关错误**
- 重新安装PyTorch：访问[PyTorch官网](https://pytorch.org/get-started/locally/)
- 检查CUDA版本兼容性（如使用GPU）
- 确认torchvision版本与PyTorch匹配

**3. 缓存相关问题**
- 如果遇到缓存错误，删除`data/PetImages/processed/`目录
- 清理`resnet50_config.json`和`temp_canvas.ps`文件
- 重启应用程序重新生成缓存

**4. 图像加载失败**
- 检查图像文件路径和格式（支持jpg/png/bmp/tiff）
- 确认Pillow库正确安装且版本兼容
- 检查图像文件是否损坏

**5. 内存不足**
- 减少批次大小设置（推荐16-32）
- 定期清理缓存（各应用中均提供缓存管理功能）
- 关闭其他占用内存的应用程序
- 对于Test3.py，使用较小的每类图片数量（500-1000）

**6. 训练过程无响应**
- 训练在后台线程中进行，请等待进度条更新
- 检查系统资源监控，确认CPU/内存使用正常
- 如果长时间无响应，可能需要重启应用程序

### 性能优化建议

**1. 缓存优化**
- 定期清理应用程序缓存（各GUI中均有清理按钮）
- 删除`data/PetImages/processed/`目录释放存储空间
- 重启应用程序重新生成优化的缓存

**2. 内存管理**
- 减少批次大小（推荐16-32，Test1.py和Test2.py）
- 使用Test3.py的性能监控面板查看内存使用情况
- 关闭其他占用内存的应用程序
- 设置合理的每类图片数量（500-1000张）

**3. 多线程优化**
- 避免同时运行多个应用程序实例
- 让后台训练线程有足够的时间完成
- 监控系统资源使用情况

**4. 数据集优化**
- 使用Test3.py的智能缓存功能避免重复处理
- 预先准备好数据集目录结构
- 选择合适的数据集大小以匹配系统性能

## 项目特色

### 🌟 教育价值
- **理论与实践结合**：从基础概念到实际应用
- **渐进式学习**：由浅入深的实验设计
- **交互式体验**：实时反馈和可视化

### 🔧 技术实践
- **现代开发实践**：模块化设计、LRU缓存、弱引用、多线程架构
- **智能缓存系统**：JSON元数据管理、缓存有效性验证
- **完整的MLOps流程**：数据预处理、模型训练、实时监控、配置管理
- **网络协议实现**：CRC-32变体算法、帧封装完整流程
- **性能监控框架**：系统资源追踪、优化建议生成

### 📈 可扩展性
- **模块化架构**：易于添加新功能
- **配置管理**：支持参数调优和实验记录
- **插件化设计**：支持自定义扩展

## 注意事项

- 虚拟环境已配置完成，推荐在虚拟环境中运行程序
- 首次运行深度学习实验时会自动下载预训练模型和数据集，需要网络连接
- GPU版本PyTorch可显著提升训练速度（Test2.py和Test3.py）
- 定期查看系统监控信息以优化性能配置
- requirements.txt包含所有必需依赖库及其精确版本号
- 项目使用了智能缓存机制，避免重复下载和处理数据
- 中文字体显示问题可通过安装中文字体包解决
- 内存使用量大时可适当减少批次大小或数据集大小
